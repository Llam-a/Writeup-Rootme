# Local File Inclusion - Wrappers

Points 40

No hint

# Overview:

Ta có form của challenge như sau, có chức năng upload file. Vậy chắc chắn sẽ exploit cái upload file để mà ta có thể up shell lên web server.Theo tất cả các payload thử [ở đây](https://github.com/payloadbox/rfi-lfi-payload-list) thì  upload file zip là khả thi nhất

![image](https://user-images.githubusercontent.com/115911041/230391573-7df05260-5128-494d-af1f-4a722103bfef.png)

# Analyse:

- Tạo 1 file shell có extension, đặt tên ngắn nhất có thể để tránh việc xảy ra lỗi `path name too long`. Ví dụ `a.php`.

- Sau đó, nén file đó thành file zip và sửa đuôi extension của file thành `.jpg` để có thể upload được.

- Sau khi upload file và tìm đường dẫn đến file đó thông qua payload `http://example.com/index.php?page=zip://pathtozipfile.jpg%23shellfilename`.Không cần có đuôi `.php` ở `shellfilename` bởi vì server sẽ mặc định đó là `.php` thì sẽ bị Attack detect.

# Solution:

- Script của file shell như sau: 

![image](https://user-images.githubusercontent.com/115911041/230396513-2c3fd673-a0a2-4508-9545-6b7ac77564c9.png)

Sau đó zip file đó rồi đổi đuôi extension `.jpg` và uploadfile và view source 

![image](https://user-images.githubusercontent.com/115911041/230397036-64a7650c-5b24-49bb-b713-14437b8b819f.png)

Ta có được đường dẫn tới zip file `tmp/upload/3fsOaeYVu.jpg`. Áp dụng payload ở trên `page=zip://tmp/upload/3fsOaeYVu.jpg%23a` 

![image](https://user-images.githubusercontent.com/115911041/230397928-1433ef4d-b672-41a3-8420-3424260e74b9.png)

Và ta đã có được tên file của flag `flag-mipkBswUppqwXlq9ZydO.php`

Vẫn làm tương tự như ban đầu chỉ khác ở phần shell 

![image](https://user-images.githubusercontent.com/115911041/230398512-8f37e6fa-35f4-4b30-94b5-7a95be74c923.png)

Sau đó view page source ta được kết quả

![image](https://user-images.githubusercontent.com/115911041/230399033-cb2228a9-c4fd-453f-80fa-ed0409a73b00.png)

Flag `lf1-Wr4pp3r_Ph4R_pwn3d`


